<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOST & FOUND</title>
<style>
body { margin:0; padding:0; background:#1f1f1f; color:#ddd; font-family:sans-serif; overflow:hidden; transition: filter 1.2s ease-in-out;}
.container { position:relative; z-index:1; max-width:800px; margin:0 auto; padding:2rem 1rem; opacity:0; transition:opacity 1.5s ease-in-out;}
.page-title { text-align:center; color:#fff; font-size:2.2rem; margin-bottom:1.5rem; }
.broadcast-input-wrapper { display:flex; gap:0.5rem; margin-bottom:1.5rem; }
#broadcast-input { flex:1; padding:0.5rem; border:none; border-radius:6px; background:rgba(255,255,255,0.08); color:#eee; }
#broadcast-send { padding:0.5rem 0.9rem; border:none; border-radius:6px; background:rgba(80,80,80,0.6); color:#fff; cursor:pointer; }
#broadcast-send:hover { background: rgba(100,100,100,0.8); }
.broadcast-list { display:flex; flex-direction:column; gap:0.8rem; }
.broadcast-card { background: rgba(255,255,255,0.05); padding:1rem; border-radius:8px; transition: all 0.3s ease; cursor:pointer; }
.broadcast-card:hover { transform: translateY(-4px); backdrop-filter: blur(8px); box-shadow:0 4px 16px rgba(0,0,0,0.5);}
.broadcast-card.dissolve { animation: cardFade 0.8s forwards; }
@keyframes cardFade { 0%{transform:rotate(0deg);opacity:1;}100%{transform:rotate(6deg);opacity:0;} }
.broadcast-message { font-size:1rem; margin-bottom:0.4rem; }
.broadcast-time { font-size:0.85rem; color:#aaa; text-align:right; }
#lostfound { text-align:center; margin:2rem 0; font-style:italic; color:rgba(200,200,200,0.7); cursor:pointer; transition:0.3s; }
#lostfound:hover { color:#FFA500; }

#spell-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.35); pointer-events:none; opacity:0; transition:opacity 1.2s ease-in-out; z-index:999; }

#fox-container { position:absolute; bottom:20%; width:80px; height:50px; opacity:0; display:flex; flex-direction:column; align-items:center; justify-content:center; transition: opacity 0.5s ease-in-out; }

#fox-svg { width:80px; height:50px; }
#fox-text { position:absolute; top:-25px; left:50%; transform:translateX(-50%); color:#ffe0b2; font-size:1rem; font-weight:bold; text-shadow:0 0 6px #FFA500; opacity:0; transition: opacity 0.5s ease-in-out;}
@keyframes foxWalk { 0% { transform: translateX(-100px); } 100% { transform: translateX(100vw); } }

@keyframes legMove {
  0%,100%{ transform: translateY(0px); }
  25%{ transform: translateY(-3px); }
  50%{ transform: translateY(0px); }
  75%{ transform: translateY(3px); }
}
#fox-leg { width:100%; height:5px; background:#FF8C42; position:absolute; bottom:5px; border-radius:2px; animation:legMove 0.5s infinite alternate;}

#people-text { position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); color:#8B0000; font-size:1.4rem; font-weight:bold; text-shadow:0 0 10px #4B0000; opacity:0; transition: opacity 0.8s ease-in-out;}
</style>
</head>
<body>
<div class="container" id="main-container">
  <h1 class="page-title">LOST & FOUND</h1>
  <div class="broadcast-input-wrapper">
    <input type="text" id="broadcast-input" placeholder="it hasn't pass……"/>
    <button id="broadcast-send">See you Sunday？</button>
  </div>
  <div class="broadcast-list" id="broadcasts"></div>
  <div id="lostfound">在不可能之海里</div>
</div>

<div id="spell-overlay">
  <div id="fox-container">
    <svg id="fox-svg" viewBox="0 0 80 50">
      <ellipse cx="30" cy="35" rx="20" ry="10" fill="#FF8C42"/>
      <circle cx="50" cy="25" r="12" fill="#FF8C42"/>
      <polygon points="45,10 50,25 40,20" fill="#FF8C42"/>
      <polygon points="60,10 55,25 65,20" fill="#FF8C42"/>
      <path d="M65 35 Q75 25 70 40" fill="#FF8C42"/>
    </svg>
    <div id="fox-text">Tomorrow is another day</div>
    <div id="fox-leg"></div>
  </div>
  <div id="people-text">People make mistakes.</div>
</div>

<script type="module">
// Firebase 广播功能
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
const firebaseConfig = { apiKey:"AIzaSyCcerqGJVSsMwLs7eoRjATE8X7bplWsD54", authDomain:"drunk-broadcast.firebaseapp.com", projectId:"drunk-broadcast", storageBucket:"drunk-broadcast.firebasestorage.app", messagingSenderId:"998143016108", appId:"1:998143016108:web:87c3a60b853aaf75f27309" };
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const ref = collection(db,"broadcasts");
const inputEl = document.getElementById("broadcast-input");
const sendBtn = document.getElementById("broadcast-send");
const listEl = document.getElementById("broadcasts");
sendBtn.onclick=async()=>{const v=inputEl.value.trim(); if(!v) return; await addDoc(ref,{message:v,timestamp:new Date()}); inputEl.value="";};
inputEl.addEventListener("keydown",e=>{if(e.key==="Enter") sendBtn.click();});
const q=query(ref,orderBy("timestamp","desc"));
onSnapshot(q,snap=>{listEl.innerHTML=""; snap.forEach(doc=>{const data=doc.data(); const d=document.createElement("div"); d.className="broadcast-card"; d.innerHTML=`<div class="broadcast-message">${data.message}</div><div class="broadcast-time">${data.timestamp.toDate().toLocaleString()}</div>`; d.onclick=()=>d.classList.add("dissolve"); listEl.appendChild(d);});});
window.addEventListener("load",()=>{document.getElementById("main-container").style.opacity="1";});
</script>

<script>
// 横走狐狸 + 暗红文字逻辑
const spellOverlay = document.getElementById("spell-overlay");
const foxContainer = document.getElementById("fox-container");
const foxText = document.getElementById("fox-text");
const lostfound = document.getElementById("lostfound");
const peopleText = document.getElementById("people-text");

lostfound.onclick = () => {
  spellOverlay.style.opacity = "1";
  foxContainer.style.opacity = "1";
  foxText.style.opacity = "1";

  // 横向行走动画
  foxContainer.style.animation = "foxWalk 4s linear forwards";

  // 显示文字在狐狸上
  foxText.textContent = "Tomorrow is another day";

  // 狐狸走完后消失
  setTimeout(()=>{
    foxContainer.style.opacity = "0";
    foxText.style.opacity = "0";

    // 显示吸血鬼暗红文字
    peopleText.style.opacity = "1";

    // 暂停2秒后淡出并回主页
    setTimeout(()=>{
      spellOverlay.style.opacity = "0";
      peopleText.style.opacity = "0";
      document.body.style.filter="none";
    },2000);

    setTimeout(()=>{window.location.href="https://liangyi-x.github.io/drunk/";},2800);

  },4000);
};
</script>
</body>
</html>
