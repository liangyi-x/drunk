<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Broadcast</title>

<style>
  body { margin:0; padding:0; background:#000; color:#fff; font-family:monospace; overflow:hidden;}

  #lostfound {
    position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
    font-size: 24px; cursor:pointer;
  }

  #spell-overlay {
    position:fixed; inset:0; background:#000; opacity:0; transition:1s;
    pointer-events:none;
  }

  /* 三层黑胶 */
  #vinyl-container {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    width:220px; height:220px; opacity:0;
  }
  .ring {
    position:absolute; inset:0; border-radius:50%; border:3px solid #fff2;
    animation: spin 5s linear infinite;
  }
  .ring.mid {
    inset:20px; animation-duration:7s;
  }
  .ring.inner {
    inset:40px; animation-duration:9s;
  }
  @keyframes spin {
    from {transform: rotate(0deg);}
    to   {transform: rotate(360deg);}
  }

  #vinyl-text {
    position:absolute; top: calc(50% + 150px); left:50%; transform:translateX(-50%);
    font-size:20px; opacity:0; transition:1s;
  }

  #people-text {
    position:absolute; top:45%; left:50%; transform:translate(-50%, -50%);
    font-size:28px; letter-spacing:1px;
    opacity:0; transition:1.2s;
  }

  /* 海浪 */
  #wave {
    position:absolute; bottom:0; width:100%; height:180px;
    opacity:0; background:url("../wave.svg") repeat-x bottom;
    background-size:contain;
    transition:1s;
  }

  /* 广播区域 */
  #broadcast {
    position:absolute; bottom:20px; left:50%; transform:translateX(-50%);
    width:90%; max-width:480px;
  }

  #list {
    margin-top:10px; font-size:14px; line-height:1.6;
    max-height:200px; overflow:auto;
  }

  input {
    width:100%; padding:8px; margin-top:5px;
    background:#111; border:1px solid #333; color:#fff;
  }

  button {
    width:100%; padding:8px; margin-top:5px;
    background:#333; border:0; color:#fff; cursor:pointer;
  }
  button:hover { background:#444; }
</style>

</head>
<body>

<div id="lostfound">点击触发魔法</div>

<div id="spell-overlay"></div>

<div id="vinyl-container">
  <div class="ring"></div>
  <div class="ring mid"></div>
  <div class="ring inner"></div>
</div>

<div id="vinyl-text">Tomorrow is waiting for you.</div>
<div id="people-text">People always meet again.</div>

<div id="wave"></div>

<!-- 广播 -->
<div id="broadcast">
  <input id="msgInput" placeholder="写点什么…">
  <button onclick="postMsg()">发广播</button>
  <div id="list"></div>
</div>

<script>
/* ============ 魔法动画 ============ */

const lostfound = document.getElementById("lostfound");
const spellOverlay = document.getElementById("spell-overlay");
const vinylContainer = document.getElementById("vinyl-container");
const vinylText = document.getElementById("vinyl-text");
const peopleText = document.getElementById("people-text");
const wave = document.getElementById("wave");

lostfound.onclick = () => {
  lostfound.style.opacity="0";

  spellOverlay.style.opacity="1";
  vinylContainer.style.opacity="1";
  vinylText.style.opacity="1";
  wave.style.opacity="1";

  /* 显示 Tomorrow */
  setTimeout(()=>{
    vinylText.style.opacity="0";

    /* 黑胶淡出 */
    vinylContainer.style.transition="1s";
    wave.style.transition="1s";
    vinylContainer.style.opacity="0";
    wave.style.opacity="0";

    /* people 显示 */
    setTimeout(()=>{
      peopleText.style.opacity="1";

      /* people 淡出并跳主页 */
      setTimeout(()=>{
        peopleText.style.opacity="0";
        spellOverlay.style.opacity="0";
        setTimeout(()=>{
          window.location.href = "https://liangyi-x.github.io/drunk/";
        },900);

      },1800);

    },1000);

  },1800);
};


/* ============ 广播系统（本地存储） ============ */

function loadMsg(){
  const arr = JSON.parse(localStorage.getItem("broadcast") || "[]");
  const list = document.getElementById("list");
  list.innerHTML = arr.map(t=>`<div>· ${t}</div>`).join("");
}

function postMsg(){
  const input = document.getElementById("msgInput");
  const text = input.value.trim();
  if(!text) return;

  const arr = JSON.parse(localStorage.getItem("broadcast") || "[]");
  arr.unshift(text);
  localStorage.setItem("broadcast", JSON.stringify(arr));

  input.value="";
  loadMsg();
}

loadMsg();
</script>
</body>
</html>

