<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOST & FOUND</title>
<style>
body { margin:0; padding:0; background:#1f1f1f; color:#ddd; font-family:sans-serif; overflow-x:hidden; transition: filter 1.2s ease-in-out;}
.container { position:relative; z-index:1; max-width:800px; margin:0 auto; padding:2rem 1rem; opacity:0; transition:opacity 1.5s ease-in-out;}
.page-title { text-align:center; color:#fff; font-size:2.2rem; margin-bottom:1.5rem; }
.broadcast-input-wrapper { display:flex; gap:0.5rem; margin-bottom:1.5rem; }
#broadcast-input { flex:1; padding:0.5rem; border:none; border-radius:6px; background:rgba(255,255,255,0.08); color:#eee; }
#broadcast-send { padding:0.5rem 0.9rem; border:none; border-radius:6px; background:rgba(80,80,80,0.6); color:#fff; cursor:pointer; }
#broadcast-send:hover { background: rgba(100,100,100,0.8); }
.broadcast-list { display:flex; flex-direction:column; gap:0.8rem; }
.broadcast-card { background: rgba(255,255,255,0.05); padding:1rem; border-radius:8px; transition: all 0.3s ease; cursor:pointer; }
.broadcast-card:hover { transform: translateY(-4px); backdrop-filter: blur(8px); box-shadow:0 4px 16px rgba(0,0,0,0.5);}
.broadcast-card.dissolve { animation: cardFade 0.8s forwards; }
@keyframes cardFade { 0%{transform:rotate(0deg);opacity:1;}100%{transform:rotate(6deg);opacity:0;} }
.broadcast-message { font-size:1rem; margin-bottom:0.4rem; }
.broadcast-time { font-size:0.85rem; color:#aaa; text-align:right; }
#lostfound { text-align:center; margin:2rem 0; font-style:italic; color:rgba(200,200,200,0.7); cursor:pointer; transition:0.3s; }
#lostfound:hover { color:#FFA500; }
#spell-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.35); pointer-events:none; opacity:0; transition:opacity 1.2s ease-in-out; z-index:999; }

/* 暗橙色狐狸动画 */
#fox-container { position:absolute; top:50%; left:50%; width:120px; height:120px; transform:translate(-50%,-50%); opacity:0; filter: drop-shadow(0 0 12px #FF8C42); transition: opacity 1.2s ease-in-out;}
#fox-container svg { width:100%; height:100%; }
@keyframes foxWiggle { 0% { transform: translate(-50%, -50%) rotate(-3deg); } 25% { transform: translate(-50%, -50%) rotate(3deg); } 50% { transform: translate(-50%, -50%) rotate(-2deg); } 75% { transform: translate(-50%, -50%) rotate(2deg); } 100% { transform: translate(-50%, -50%) rotate(0deg); } }
@keyframes foxFloat { 0% { transform: translate(-50%, -50%) translateY(0px); } 50% { transform: translate(-50%, -50%) translateY(-5px); } 100% { transform: translate(-50%, -50%) translateY(0px); } }
@keyframes textFloat { 0% { transform: translate(-50%, -50%) translateY(0px); } 50% { transform: translate(-50%, -50%) translateY(-6px); } 100% { transform: translate(-50%, -50%) translateY(0px); } }
@keyframes text-glow { 0%,100% { text-shadow:0 0 8px #FFA500,0 0 12px #FFD580; } 50% { text-shadow:0 0 16px #FFA500,0 0 24px #FFD580; } }

#fox-text { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#ffe0b2; font-size:1.2rem; font-weight:bold; text-shadow:0 0 12px #FFA500; opacity:0; transition: opacity 1.5s ease-in-out; pointer-events:none;}
</style>
</head>
<body>
<div class="container" id="main-container">
  <h1 class="page-title">LOST & FOUND</h1>
  <div class="broadcast-input-wrapper">
    <input type="text" id="broadcast-input" placeholder="it hasn't pass……"/>
    <button id="broadcast-send">See you Sunday？</button>
  </div>
  <div class="broadcast-list" id="broadcasts"></div>
  <div id="lostfound">在不可能之海里</div>
</div>

<div id="spell-overlay">
  <div id="fox-container">
    <svg viewBox="0 0 120 120">
      <ellipse cx="60" cy="70" rx="35" ry="40" fill="#FF8C42"/>
      <circle cx="60" cy="40" r="25" fill="#FF8C42"/>
      <polygon points="45,20 55,40 40,35" fill="#FF8C42"/>
      <polygon points="75,20 65,40 80,35" fill="#FF8C42"/>
      <path d="M95 80 Q110 60 100 90" fill="#FF8C42"/>
    </svg>
    <div id="fox-text">Tomorrow is another day</div>
  </div>
</div>

<script type="module">
// Firebase 广播功能
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
const firebaseConfig = { apiKey:"AIzaSyCcerqGJVSsMwLs7eoRjATE8X7bplWsD54", authDomain:"drunk-broadcast.firebaseapp.com", projectId:"drunk-broadcast", storageBucket:"drunk-broadcast.firebasestorage.app", messagingSenderId:"998143016108", appId:"1:998143016108:web:87c3a60b853aaf75f27309" };
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const ref = collection(db,"broadcasts");
const inputEl = document.getElementById("broadcast-input");
const sendBtn = document.getElementById("broadcast-send");
const listEl = document.getElementById("broadcasts");
sendBtn.onclick=async()=>{const v=inputEl.value.trim(); if(!v) return; await addDoc(ref,{message:v,timestamp:new Date()}); inputEl.value="";};
inputEl.addEventListener("keydown",e=>{if(e.key==="Enter") sendBtn.click();});
const q=query(ref,orderBy("timestamp","desc"));
onSnapshot(q,snap=>{listEl.innerHTML=""; snap.forEach(doc=>{const data=doc.data(); const d=document.createElement("div"); d.className="broadcast-card"; d.innerHTML=`<div class="broadcast-message">${data.message}</div><div class="broadcast-time">${data.timestamp.toDate().toLocaleString()}</div>`; d.onclick=()=>d.classList.add("dissolve"); listEl.appendChild(d);});});
window.addEventListener("load",()=>{document.getElementById("main-container").style.opacity="1";});
</script>

<script>
// 魔法粒子和狐狸动画
const spellOverlay = document.getElementById("spell-overlay");
const fox = document.getElementById("fox-container");
const foxText = document.getElementById("fox-text");

function spawnRunes(count=25){
  for(let i=0;i<count;i++){
    const rune = document.createElement("div");
    const size=6+Math.random()*12;
    rune.style.width=rune.style.height=size+"px";
    rune.style.borderRadius="50%";
    rune.style.position="absolute";
    rune.style.top=Math.random()*100+"%";
    rune.style.left=Math.random()*100+"%";
    rune.style.opacity="0";
    rune.style.background=`radial-gradient(circle, hsl(${Math.random()*360},100%,75%), hsl(${Math.random()*360},80%,50%))`;
    rune.style.boxShadow=`0 0 ${5+Math.random()*10}px #FFA500`;
    document.body.appendChild(rune);
    setTimeout(()=>{rune.style.opacity="1";},Math.random()*300);

    const colorAnim = setInterval(()=>{
      rune.style.background=`radial-gradient(circle, hsl(${Math.random()*360},100%,75%), hsl(${Math.random()*360},80%,50%))`;
      rune.style.boxShadow=`0 0 ${5+Math.random()*10}px #FFA500`;
    },400+Math.random()*600);

    const amplitudeX=(Math.random()-0.5)*80;
    const amplitudeY=(Math.random()-0.5)*80;
    const rotate=(Math.random()-0.5)*20;
    rune.animate([{transform:`translate(0,0) rotate(0deg)`},{transform:`translate(${amplitudeX}px,${amplitudeY}px) rotate(${rotate}deg)`},{transform:`translate(0,0) rotate(0deg)`}],{duration:4000+Math.random()*4000,iterations:Infinity,easing:'ease-in-out'});
    rune.animate([{transform:'translateY(0px)'},{transform:'translateY(-5px)'},{transform:'translateY(0px)'},{transform:'translateY(5px)'},{transform:'translateY(0px)'}],{duration:2500+Math.random()*1000,iterations:Infinity,easing:'ease-in-out'});

    setTimeout(()=>{rune.remove(); clearInterval(colorAnim);},8000);
  }
}

document.getElementById("lostfound").onclick=()=>{
  spellOverlay.style.opacity="1";
  fox.style.opacity="1";
  fox.style.animation="foxWiggle 3s infinite ease-in-out, foxFloat 2.5s infinite alternate";
  foxText.style.animation="textFloat 2.5s infinite alternate, text-glow 2s infinite alternate";
  spawnRunes(25);
  document.body.style.filter="blur(1.5px) brightness(0.85)";

  // 显示 first text
  foxText.textContent="Tomorrow is another day";
  foxText.style.opacity="1";

  setTimeout(()=>{
    // 淡出 first text
    foxText.style.opacity="0";
    setTimeout(()=>{
      // 显示 second text
      foxText.textContent="People make mistakes.";
      foxText.style.opacity="1";
    },1500);
  },2500);

  // 最后淡出并回主页
  setTimeout(()=>{
    spellOverlay.style.opacity="0";
    foxText.style.opacity="0";
    document.body.style.filter="none";
  },5000);

  setTimeout(()=>{window.location.href="https://liangyi-x.github.io/drunk/";},5800);
};
</script>
</body>
</html>
