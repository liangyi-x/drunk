{{ define "main" }}

<main class="main-content">

  {{- /* 首页不显示 breadcrumbs */ -}}
  {{- if not .IsHome }}
    {{ partial "breadcrumbs.html" . }}
  {{- end }}

  {{- /* 分页文章列表 */ -}}
  {{- $paginator := .Paginate (where .Pages "Section" "posts") }}

  {{- range $paginator.Pages }}
    <article class="post-entry">

      {{- /* 封面 */ -}}
      {{- $isHidden := (.Param "cover.hiddenInList") | default (.Param "cover.hidden") | default false }}
      {{- partial "cover.html" (dict "cxt" . "IsHome" false "isHidden" $isHidden) }}

      <header class="entry-header">
        <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
      </header>

      <div class="entry-content">
        {{- /* 显示摘要：优先 summary，否则正文第一行 */ -}}
        {{- if .Params.summary }}
          <p>{{ .Params.summary }}</p>
        {{- else }}
          {{- $firstLine := index (split (.Plain) "\n") 0 }}
          <p>{{ $firstLine }}</p>
        {{- end }}
      </div>

      <footer class="entry-footer">
        {{ partial "post_meta.html" . }}
        <a class="entry-link" href="{{ .Permalink }}">阅读全文</a>
      </footer>

    </article>
  {{- end }}

  {{- /* 分页 */ -}}
  {{- with partial "pagination.html" (dict "paginator" $paginator "context" .) }}
  {{- end }}

</main>

{{ end }}
